---
# Expanso Edge Demo - Simple local setup
#
# Usage:
#   docker compose up -d --scale edge=6
#   tail -f logs/web.log
#   docker compose down

services:
  hec:
    image: python:3.11-slim
    ports:
      - "127.0.0.1:8088:8088"
    volumes:
      - ./docker/hec-receiver.py:/app/hec-receiver.py:ro
      - ./logs:/app/logs
    environment:
      - LOG_DIR=/app/logs
    working_dir: /app
    command: python /app/hec-receiver.py

  edge:
    image: ghcr.io/expanso-io/expanso-edge:nightly
    environment:
      - EXPANSO_EDGE_BOOTSTRAP_URL=${EXPANSO_EDGE_BOOTSTRAP_URL}
      - EXPANSO_EDGE_BOOTSTRAP_TOKEN=${EXPANSO_EDGE_BOOTSTRAP_TOKEN}
    command: ["run", "--verbose"]
    depends_on:
      - hec
